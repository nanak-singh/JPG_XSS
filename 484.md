When a new Citi_authorization session token is created via the token creation API, the previously issued token should ideally be invalidated immediately to prevent concurrent valid tokens for the same user. In the tested implementation, the old token remains active and functional for its full validity period (e.g., 1800 seconds), even after a new token has been generated.

Recommendation:

Immediate Invalidation: Invalidate the old token when a new token is generated for the same user/session.

Single Active Session Policy: Maintain only one active token per user/device at a time.

Server-Side Tracking: Implement server-side token revocation lists or state tracking to ensure only the most recent token is valid.

Shorter Token Lifetimes: Reduce token TTL if immediate invalidation is not feasible.

Active Monitoring: Log and alert on concurrent token usage from different IP addresses or geolocations.



Call the token creation API to obtain a valid Citi_authorization token (Token A).

Before Token A expires, call the token creation API again to generate a new token (Token B).

Use Token A to access an authenticated API endpoint.

Observe that Token A remains valid and functional despite Token B being issued.

